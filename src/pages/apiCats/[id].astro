---
import MiLayout from "../../layouts/MiLayout.astro";


interface Cat {
    id: string
    url: string
}

const url = "https://api.thecatapi.com/v1/images/search?api_key="

const apikey = "live_AEGOOQEwID2TGu8s8J9CNgu1Mvyv8vaBrhRrhtLaCbFJF7HJgP9bNuwR8h18tYFQ/"


export async function getStaticPaths() {
    
    const response = await fetch(url+apikey)
    const cats:Cat[] = await response.json()
    return cats.map((cat:Cat) => ({
        params: {id: cat.id.toString()}, props: {cat:cat}
    }))
} 
// Astro may not always provide `props` (for example during some dev renders),
// so access it safely and fall back to null.
const cat: Cat | null = (Astro.props && Astro.props.cat) ? Astro.props.cat : null;
    
---


<MiLayout>
    <h1>Cats</h1>
    {cat ? (
        <>
            <h2>Gato numero {cat.id}</h2>
            <p><img src={cat.url} alt={`Cat ${cat.id}`} /></p>
        </>
    ) : (
        <p>Cat data is not available. Try rebuilding or visit a generated path.</p>
    )}
</MiLayout>